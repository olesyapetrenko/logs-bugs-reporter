This commit contains all the changes that came after CW-63 (last 5 commits are not relevant). 
